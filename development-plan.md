# 多项目智能管理系统详细开发计划（基于 spec.md）

## 1. 计划目标与约束

### 1.1 目标
- 在 14 周内交付可上线的 MVP（方案 A：模块化单体）
- 覆盖能力：Dashboard、需求管理、成本管理、进度管理、AI 助理、基础权限
- 达成业务验证指标：
  - 项目延期率可观测并可预警
  - 需求变更响应时间可量化下降
  - 项目经理周报耗时显著降低

### 1.2 约束
- 技术路线固定：React + NestJS + PostgreSQL + Redis + LLM API
- 非目标不进入本期：低代码平台、复杂财务核算、企业级多层审批引擎
- AI 能力遵循“事实约束 + 可追溯”

## 2. 团队配置与职责

## 2.1 推荐人力（最小可执行）
- 产品经理（1）：需求澄清、验收、优先级管理
- 技术负责人（1）：架构、代码规范、关键技术决策
- 前端工程师（2）：管理端页面与可视化
- 后端工程师（3）：业务模块、聚合计算、AI 接口
- 测试工程师（1）：测试策略、回归、上线验收
- DevOps（0.5）：环境、CI/CD、监控告警

### 2.2 职责边界
- 前端负责：Dashboard、需求/进度/成本页面、交互状态管理
- 后端负责：领域模块、RBAC、风险规则、报表与 AI 服务
- 测试负责：接口自动化 + 核心 E2E + 性能基线
- 产品负责：每周需求冻结与变更控制

## 3. 里程碑与时间表（14 周）

### M0：项目启动（第 1 周）
- 交付物：
  - PRD 冻结版
  - 技术方案确认版（方案 A）
  - 仓库结构、分支策略、代码规范
- 验收标准：
  - 架构评审通过
  - 数据口径与指标口径文档可签字

### M1：最小可跑通版本（第 2-6 周）
- 目标：完成核心业务闭环与基础 Dashboard
- 范围：
  - 登录/RBAC/组织与项目管理
  - 需求基础流：创建、评审、纳入版本
  - 成本基础：工时/外采/云成本录入、预算录入
  - 进度基础：看板 + 里程碑
  - Dashboard 核心 6 卡片
- 里程碑验收：
  - 项目从创建到周报草稿可端到端走通（不含高级风险解释）

### M2：核心能力补全（第 7-11 周）
- 目标：补齐复杂流程与风险管理
- 范围：
  - 需求变更追踪与审计时间线
  - 甘特/WBS + 任务依赖
  - 风险规则引擎（延期、阻塞、超预算）
  - AI 助理（风险摘要、周报草稿）
  - 通知中心与邮件告警
- 里程碑验收：
  - 风险可自动触发、可解释、可追溯

### M3：工程化与上线准备（第 12-14 周）
- 目标：稳定性、性能、可运维能力达标
- 范围：
  - 聚合查询优化（缓存 + 增量刷新）
  - 自动化测试补齐（接口/E2E/回归）
  - 监控告警、审计日志、错误追踪
  - 上线演练、灰度发布、回滚预案
- 里程碑验收：
  - 通过 UAT + 生产发布门禁

## 4. 迭代拆解（按 Sprint）

### Sprint 1（第 1-2 周）
- 后端：
  - 初始化 NestJS 工程、模块骨架、统一异常/日志
  - PostgreSQL + Prisma 初始化迁移
  - Auth/RBAC 基础接口
- 前端：
  - React 管理端框架、路由、权限菜单框架
  - 登录页、项目列表页初版
- 测试：
  - 测试框架搭建（API + E2E 脚手架）
- 验收：
  - 可登录、可创建项目、权限可生效

### Sprint 2（第 3-4 周）
- 后端：
  - 需求管理：需求 CRUD、评审流、版本关联
  - 审计日志基础
- 前端：
  - 需求池、需求详情、评审页面
  - 版本规划基础视图
- 测试：
  - 需求流主路径自动化用例
- 验收：
  - 需求从 draft 到 approved 流转可用

### Sprint 3（第 5-6 周）
- 后端：
  - 成本录入（工时/外采/云）与预算模型
  - 进度基础（里程碑、看板状态）
  - Dashboard 聚合任务 v1（定时刷新）
- 前端：
  - 成本录入页、预算对比图
  - 看板页、里程碑页
  - Dashboard v1
- 测试：
  - 成本偏差计算、里程碑偏差校验
- 验收：
  - M1 里程碑达成

### Sprint 4（第 7-8 周）
- 后端：
  - 需求变更追踪（diff + 原因 + 操作人）
  - 甘特/WBS 数据模型与接口
- 前端：
  - 需求变更时间线
  - 甘特/WBS 视图
- 测试：
  - 变更追踪正确性与权限校验

### Sprint 5（第 9-10 周）
- 后端：
  - 风险规则引擎（延期、超预算、阻塞）
  - 风险事件表与告警策略
  - AI 助理服务 v1（周报草稿）
- 前端：
  - 风险中心页面
  - AI 结果展示与确认交互
- 测试：
  - 风险触发规则边界用例
  - AI 输出格式与事实字段校验

### Sprint 6（第 11-12 周）
- 后端：
  - Dashboard 查询优化（聚合表 + Redis 缓存）
  - 通知中心（站内 + 邮件）
- 前端：
  - Dashboard 筛选与多项目对比增强
  - 通知中心 UI
- 测试：
  - 接口压测与关键页面性能测试
- 验收：
  - M2 里程碑达成

### Sprint 7（第 13-14 周）
- 全栈：
  - 缺陷修复、稳定性增强、日志完善
  - 发布脚本、灰度发布、回滚验证
- 测试：
  - 全量回归 + UAT + 冒烟
- 验收：
  - M3 达成并上线

## 5. 工作分解结构（WBS）

### 5.1 后端 WBS
- B1 基础框架：认证、权限、审计、错误处理
- B2 需求域：需求/评审/变更/版本
- B3 成本域：预算、工时、外采、云成本、偏差计算
- B4 进度域：任务、里程碑、依赖、看板状态
- B5 Dashboard：聚合任务、查询接口、缓存
- B6 AI 域：提示词模板、事实约束、输出记录
- B7 平台能力：通知、导出、监控、配置管理

### 5.2 前端 WBS
- F1 框架层：布局、权限路由、状态管理、请求封装
- F2 Dashboard：健康度卡片、趋势图、风险清单
- F3 需求模块：需求池、评审、变更时间线、版本视图
- F4 进度模块：看板、甘特/WBS、里程碑
- F5 成本模块：录入表单、预算对比、趋势分析
- F6 AI 模块：摘要展示、草稿编辑、导出

### 5.3 QA WBS
- Q1 测试计划与准入准出标准
- Q2 接口自动化（核心接口覆盖）
- Q3 E2E 场景（主路径）
- Q4 性能测试（Dashboard、聚合刷新）
- Q5 上线回归与生产冒烟

## 6. 环境与发布计划

### 6.1 环境
- Dev：开发联调
- Test：功能测试 + 回归测试
- Staging：预发布/UAT
- Prod：生产

### 6.2 发布策略
- 每 2 周一个发布候选（RC）
- 生产采用灰度发布（10% -> 50% -> 100%）
- 提供 1 小时内可执行回滚脚本（应用版本 + 数据兼容策略）

## 7. 质量保障计划

### 7.1 DoD（Definition of Done）
- 功能代码合并前通过：
  - 单元测试
  - 关键接口测试
  - 安全扫描（依赖漏洞）
  - 代码评审（至少 1 名 reviewer）
- 文档同步更新：
  - 接口文档
  - 数据字典
  - 变更记录

### 7.2 测试覆盖目标
- 单元测试覆盖率：后端核心域 >= 70%
- 接口自动化覆盖：P0/P1 接口 >= 90%
- E2E 覆盖：核心用户路径 >= 80%

### 7.3 性能目标（MVP）
- Dashboard 首屏接口 P95 < 800ms
- 关键写接口 P95 < 500ms
- 聚合任务单轮完成时间 < 3 分钟（100 项目规模）

## 8. 数据与安全计划

### 8.1 数据治理
- 成本口径统一字典（labor/outsource/cloud）
- 指标口径版本化（health_score、variance）
- 审计日志保留策略（>= 180 天）

### 8.2 安全控制
- RBAC 最小权限原则
- 敏感字段脱敏（如人员费率）
- AI 输入输出审计（防止敏感数据泄露）

## 9. 风险清单与应对

### 9.1 高风险项
- R1 风险规则误报高，影响信任
- R2 Dashboard 查询性能不足
- R3 AI 生成结论不可追溯
- R4 成本数据来源不一致
- R5 需求变更频繁导致范围膨胀

### 9.2 应对措施
- R1：先上线可解释规则 + 阈值可配置
- R2：聚合表与缓存优先，避免在线复杂 join
- R3：输出附证据字段和时间窗口
- R4：建立导入校验与口径校验任务
- R5：每周需求冻结，变更走 CCB 轻流程

## 10. 验收与运营指标

### 10.1 功能验收清单
- 项目、需求、成本、进度、Dashboard、AI 助理主路径可用
- 关键接口文档齐全且可联调
- 告警与通知链路可闭环

### 10.2 上线后 1-3 个月指标
- 项目延期率：较基线下降（目标 15%+）
- 需求变更响应时间：较基线缩短（目标 20%+）
- PM 周报耗时：较基线下降（目标 40%+）
- 月活跃项目经理数与周活跃率持续增长

## 11. 管理机制（执行建议）

### 11.1 节奏
- 每日站会：15 分钟，阻塞项清零
- 每周评审：产品 + 技术 + QA 联合评审
- 每双周复盘：版本复盘与风险复盘

### 11.2 变更控制
- P0/P1 需求变更需产品与技术负责人共同批准
- 非紧急变更顺延至下个 Sprint
- 所有变更必须更新排期与影响评估

## 12. 附录：首批任务清单（可直接建 Jira）

- FE-001 登录页与权限路由
- FE-002 Dashboard v1（健康度/风险/趋势）
- FE-003 需求池与评审页面
- FE-004 看板与里程碑页面
- FE-005 成本录入与预算对比
- FE-006 甘特/WBS 视图
- FE-007 AI 周报草稿展示与编辑
- BE-001 用户认证与 RBAC
- BE-002 项目管理 API
- BE-003 需求/评审/版本 API
- BE-004 需求变更追踪 API
- BE-005 工时与成本 API
- BE-006 进度与里程碑 API
- BE-007 风险规则引擎
- BE-008 Dashboard 聚合任务与查询 API
- BE-009 AI 报告生成 API
- BE-010 通知中心 API
- QA-001 核心接口自动化
- QA-002 E2E 主路径自动化
- QA-003 性能测试与阈值告警
